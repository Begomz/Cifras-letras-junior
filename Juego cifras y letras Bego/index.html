<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Cifras y Letras Junior</title>

<style>
body {
  margin: 0;
  background: #eef2f5;
  font-family: Arial, sans-serif;
}

#app {
  max-width: 1400px;
  margin: auto;
  padding: 30px;
  text-align: center;
}

h1 { font-size: 3vw; }

.panel {
  background: white;
  border-radius: 30px;
  padding: 30px;
  margin-bottom: 30px;
}

button {
  font-size: 1.8vw;
  padding: 18px 28px;
  margin: 12px;
  border-radius: 25px;
  border: none;
  background: #4caf50;
  color: white;
  cursor: pointer;
}

button:hover { background: #43a047; }

.niveles button {
  background: #6a1b9a;
}

.niveles button.activo {
  background: #9c27b0;
}

.botones-tiempo button {
  background: #1976d2;
}

#tiempo {
  font-size: 6vw;
  color: #2e7d32;
  margin: 20px;
}

.conjunto {
  display: flex;
  justify-content: center;
  flex-wrap: wrap;
  gap: 25px;
  margin: 25px 0;
}

.conjunto span {
  font-size: 4vw;
  padding: 20px 28px;
  background: #e3f2fd;
  border-radius: 20px;
}

.solucion {
  display: none;
  margin-top: 20px;
  padding: 20px;
  font-size: 2vw;
  background: #fff3cd;
  border-radius: 20px;
}

footer {
  margin-top: 40px;
  padding: 20px;
  font-size: 1.2vw;
  color: #555;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 20px;
}

footer img { height: 60px; }
</style>
</head>

<body>

<div id="app">

<h1>ğŸ® Cifras y Letras Junior</h1>

<!-- NIVELES -->
<div class="panel niveles">
  <h2>ğŸšï¸ Nivel</h2>
  <button onclick="cambiarNivel(3)">3.Âº</button>
  <button onclick="cambiarNivel(4)">4.Âº</button>
  <button onclick="cambiarNivel(5)" class="activo">5.Âº</button>
  <button onclick="cambiarNivel(6)">6.Âº</button>
</div>

<!-- TIEMPO -->
<div class="panel">
  <h2>â±ï¸ Tiempo</h2>
  <div class="botones-tiempo">
    <button onclick="ajustarTiempo(60)">60 s</button>
    <button onclick="ajustarTiempo(90)">90 s</button>
    <button onclick="ajustarTiempo(120)">120 s</button>
  </div>
  <div id="tiempo">90</div>
  <button onclick="iniciar()">â–¶ï¸ Iniciar</button>
</div>

<!-- LETRAS -->
<div class="panel">
  <h2>ğŸ”¤ LETRAS</h2>
  <div class="conjunto" id="letras"></div>
  <button onclick="generarLetras()">Generar letras</button>
  <button onclick="mostrarSolucionLetras()">ğŸ‘©â€ğŸ« SoluciÃ³n</button>
  <div class="solucion" id="solLetras"></div>
</div>

<!-- CIFRAS -->
<div class="panel">
  <h2>ğŸ”¢ CIFRAS</h2>
  <div class="conjunto" id="numeros"></div>
  <h3>ğŸ¯ Objetivo: <span id="objetivo"></span></h3>
  <button onclick="generarCifras()">Generar cifras</button>
  <button onclick="mostrarSolucionCifras()">ğŸ‘©â€ğŸ« SoluciÃ³n</button>
  <div class="solucion" id="solCifras"></div>
</div>

<footer>
  <img src="logo.png" alt="Logo del recurso">
  <div>
    <strong>BegoÃ±a Mella</strong><br>
    Material educativo de uso docente
  </div>
</footer>

</div>

<script src="diccionario_escolar.js"></script>

<script>
/* ========= CONFIGURACIÃ“N POR NIVEL ========= */
let nivel = 5;

const configNivel = {
  3: { minPalabra: 4, ops: 2 },
  4: { minPalabra: 5, ops: 2 },
  5: { minPalabra: 6, ops: 3 },
  6: { minPalabra: 7, ops: 4 }
};

function cambiarNivel(n) {
  nivel = n;
  document.querySelectorAll(".niveles button")
    .forEach(b => b.classList.remove("activo"));
  event.target.classList.add("activo");
}

/* ========= TEMPORIZADOR ========= */
let tiempo = 90;
let intervalo;

function iniciar() {
  clearInterval(intervalo);
  intervalo = setInterval(() => {
    tiempo--;
    document.getElementById("tiempo").textContent = tiempo;
    if (tiempo <= 0) clearInterval(intervalo);
  }, 1000);
}

function ajustarTiempo(t) {
  tiempo = t;
  document.getElementById("tiempo").textContent = tiempo;
}

/* ========= LETRAS ========= */
let letrasActuales = [];

function generarLetras() {
  const total = 9;
  const min = configNivel[nivel].minPalabra;

  const posibles = Object.keys(DICCIONARIO_ESCOLAR)
    .map(n => parseInt(n))
    .filter(n => n >= min && n <= total);

  const len = posibles[Math.floor(Math.random()*posibles.length)];
  const palabra =
    DICCIONARIO_ESCOLAR[len][
      Math.floor(Math.random()*DICCIONARIO_ESCOLAR[len].length)
    ].toUpperCase();

  letrasActuales = palabra.split("");

  const vocales = "AEIOU";
  const consonantes = "BCDFGHJKLMNPRSTL";

  while (letrasActuales.length < total) {
    letrasActuales.push(
      Math.random() < 0.45
        ? vocales[Math.floor(Math.random()*vocales.length)]
        : consonantes[Math.floor(Math.random()*consonantes.length)]
    );
  }

  letrasActuales.sort(() => Math.random() - 0.5);

  document.getElementById("letras").innerHTML =
    letrasActuales.map(l => `<span>${l}</span>`).join("");

  document.getElementById("solLetras").style.display = "none";
}

function mostrarSolucionLetras() {
  for (let len = 9; len >= configNivel[nivel].minPalabra; len--) {
    const lista = DICCIONARIO_ESCOLAR[len] || [];
    for (let palabra of lista) {
      let disp = letrasActuales.slice();
      let ok = true;
      for (let c of palabra.toUpperCase()) {
        let i = disp.indexOf(c);
        if (i === -1) { ok = false; break; }
        disp.splice(i,1);
      }
      if (ok) {
        document.getElementById("solLetras").textContent =
          "Palabra posible: " + palabra.toUpperCase();
        document.getElementById("solLetras").style.display = "block";
        return;
      }
    }
  }
}

/* ========= CIFRAS ========= */
let numerosActuales = [];
let objetivo = 0;
let solucionCifras = "";

function generarCifras() {
  const p = [1,2,3,4,5,6,7,8,9,10];
  const g = [25,50,75,100];

  let a = p[Math.floor(Math.random()*10)];
  let b = p[Math.floor(Math.random()*10)];
  let c = g[Math.floor(Math.random()*4)];
  let d = p[Math.floor(Math.random()*10)] || 1;

  let paso1 = a + b;
  let paso2 = paso1 * c;
  let paso3 = paso2 - d;

  if (paso3 % d !== 0) paso3 += d - (paso3 % d);

  objetivo = paso3 / d;

  solucionCifras = `((${a} + ${b}) Ã— ${c} âˆ’ ${d}) Ã· ${d} = ${objetivo}`;

  numerosActuales = [a,b,c,d,
    p[Math.floor(Math.random()*10)],
    g[Math.floor(Math.random()*4)]
  ].sort(() => Math.random() - 0.5);

  document.getElementById("numeros").innerHTML =
    numerosActuales.map(n => `<span>${n}</span>`).join("");

  document.getElementById("objetivo").textContent = objetivo;
  document.getElementById("solCifras").style.display = "none";
}

function mostrarSolucionCifras() {
  document.getElementById("solCifras").textContent =
    "SoluciÃ³n posible: " + solucionCifras;
  document.getElementById("solCifras").style.display = "block";
}
</script>

</body>
</html>
